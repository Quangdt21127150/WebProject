<%- include('../../shared/homepage/head', { pageTitle: 'All Products' }) %>
<link rel="stylesheet" href="/styles/products.css">
</head>
<body>
  <%- include('../../shared/homepage/header') %>
  <main>
    <h1 class="my-2">All Products</h1>

    <form id="searchForm" action="/products" method="GET">
      <input type="hidden" name="_csrf" value="<%= locals.csrfToken %>" />
      <div class="d-flex mt-3">
        <input type="search" name="name" class="form-control rounded-end-0" placeholder="Search" value="<%= name %>"/>
        <button type="submit" class="btn btn-solid rounded-0 rounded-end-1 p-2">
          <i class="fas fa-search"></i>
        </button>
      </div>

      <div class="d-flex mt-3">
        <label for="categories" class="fs-3">Category</label>
        <select id="categories" name="cateID" class="rounded-2 ms-2">
          <option value="all">All</option>
          <% for (const category of categories) { %>
            <option value="<%= category.id %>"><%= category.title %></option>
          <% } %>
        </select>
      </div>

      <div class="d-flex mt-3">
        <label for="price" class="fs-3">Price</label>
        <select name="price" id="price" class="mx-2 rounded-2">
          <option value="all">All</option>
          <option value="cheap">&lt; 100.000</option>
          <option value="medium">100.000 - 500.000</option>
          <option value="expensive">&gt; 500.000</option>
        </select>

        <button type="submit" class="btn btn-solid p-2 ms-1">
          <i class="fa-solid fa-filter"></i>
        </button>
      </div>
    </form>
  
    <ul id="products-grid">
      <% for (let i = start; i < end; ++i) { %>
        <li>
          <%- include('../../shared/homepage/product-item', { product: products[i] }) %>
        </li>
      <% } %>
    </ul>

    
    <ul class="pagination mb-3">
      <li class="page-item">
        <a class="btn btn-alt rounded-0 rounded-start-2 page-link" href="/products?page=<%= page <= 1 ? 1 : page - 1 %>&name=<%= name %>&cateID=<%= cateID %>&price=<%= price %>" aria-label="Previous">
          <span aria-hidden="true">&laquo;</span>
        </a>
      </li>

      <% for (let i = 1; i <= total_page; ++i) { %>
        <% if (i === page) { %>
          <li class="page-item">
            <a class="btn btn-solid rounded-0 page-link" href="/products?page=<%= i%>&name=<%= name %>&cateID=<%= cateID %>&price=<%= price %>"><%= i%></a>
          </li>
        <% } else { %>
          <li class="page-item">
            <a class="btn btn-alt rounded-0 page-link" href="/products?page=<%= i%>&name=<%= name %>&cateID=<%= cateID %>&price=<%= price %>"><%= i%></a>
          </li>
        <% } %>
      <% } %>

      <li class="page-item">
        <a class="btn btn-alt rounded-0 rounded-end-2 page-link" href="/products?page=<%= page >= total_page ? total_page : page + 1 %>&name=<%= name %>&cateID=<%= cateID %>&price=<%= price %>" aria-label="Next">
          <span aria-hidden="true">&raquo;</span>
        </a>
      </li>
    </ul>
  </main>
<%- include('../../shared/homepage/footer') %>